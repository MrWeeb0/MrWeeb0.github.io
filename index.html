<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnZy - Învățare Personalizată de Matematică</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #f72585;
            --gray: #adb5bd;
            --gray-dark: #495057;
            
            --bg: #ffffff;
            --text: #212529;
            --card-bg: #f8f9fa;
            --border: #dee2e6;
        }

        [data-theme="dark"] {
            --bg: #1a1a2e;
            --text: #f8f9fa;
            --card-bg: #16213e;
            --border: #495057;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        button {
            cursor: pointer;
            font-family: inherit;
        }

        /* Utility Classes */
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-1 {
            gap: 0.5rem;
        }

        .gap-2 {
            gap: 1rem;
        }

        .gap-3 {
            gap: 1.5rem;
        }

        .gap-4 {
            gap: 2rem;
        }

        .p-2 {
            padding: 1rem;
        }

        .p-4 {
            padding: 2rem;
        }

        .py-2 {
            padding-top: 1rem;
            padding-bottom: 1rem;
        }

        .py-4 {
            padding-top: 2rem;
            padding-bottom: 2rem;
        }

        .px-4 {
            padding-left: 2rem;
            padding-right: 2rem;
        }

        .my-2 {
            margin-top: 1rem;
            margin-bottom: 1rem;
        }

        .my-4 {
            margin-top: 2rem;
            margin-bottom: 2rem;
        }

        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        .text-center {
            text-align: center;
        }

        .text-primary {
            color: var(--primary);
        }

        .text-success {
            color: var(--success);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-danger {
            color: var(--danger);
        }

        .bg-primary {
            background-color: var(--primary);
        }

        .bg-success {
            background-color: var(--success);
        }

        .bg-warning {
            background-color: var(--warning);
        }

        .bg-danger {
            background-color: var(--danger);
        }

        .rounded {
            border-radius: 0.5rem;
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .shadow {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .shadow-lg {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .hidden {
            display: none;
        }

        .w-full {
            width: 100%;
        }

        .max-w-md {
            max-width: 28rem;
        }

        .h-screen {
            height: 100vh;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .animate-fade {
            animation: fadeIn 0.5s ease-out;
        }

        .animate-slide {
            animation: slideIn 0.5s ease-out;
        }

        .animate-pulse {
            animation: pulse 2s infinite;
        }

        /* Components */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-ghost {
            background-color: transparent;
            color: var(--primary);
        }

        .btn-ghost:hover {
            background-color: rgba(67, 97, 238, 0.1);
        }

        .card {
            background-color: var(--card-bg);
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .input-label {
            font-weight: 500;
            color: var(--text);
        }

        .input-field {
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            background-color: var(--bg);
            color: var(--text);
            font-family: inherit;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(67, 97, 238, 0.2);
        }

        .alert {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
        }

        .alert-error {
            background-color: rgba(247, 37, 133, 0.1);
            border-left: 4px solid var(--danger);
            color: var(--danger);
        }

        .progress-bar {
            height: 0.5rem;
            background-color: var(--border);
            border-radius: 0.25rem;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            transition: width 0.3s ease;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-primary {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .badge-success {
            background-color: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background-color: rgba(248, 150, 30, 0.1);
            color: var(--warning);
        }

        /* Layout */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            background-color: var(--bg);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .sidebar {
            width: 250px;
            height: calc(100vh - 70px);
            position: fixed;
            top: 70px;
            left: 0;
            background-color: var(--bg);
            border-right: 1px solid var(--border);
            padding: 1.5rem;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            color: var(--text);
            text-decoration: none;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }

        .sidebar-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .sidebar-item.active {
            background-color: rgba(67, 97, 238, 0.2);
            color: var(--primary);
            font-weight: 500;
        }

        .main-content {
            margin-left: 250px;
            padding: 2rem;
            min-height: calc(100vh - 70px);
        }

        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        /* Auth Pages */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--bg);
        }

        .auth-card {
            width: 100%;
            max-width: 400px;
            padding: 2rem;
            background-color: var(--card-bg);
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .auth-logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .auth-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .auth-subtitle {
            color: var(--gray);
            font-size: 0.875rem;
        }

        /* Quiz Styles */
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .quiz-question {
            margin-bottom: 2rem;
        }

        .quiz-question-text {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }

        .quiz-option {
            display: block;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quiz-option:hover {
            border-color: var(--primary);
        }

        .quiz-option.selected {
            background-color: rgba(67, 97, 238, 0.1);
            border-color: var(--primary);
        }

        .quiz-progress {
            margin-bottom: 2rem;
        }

        .quiz-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        /* Dashboard Styles */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .dashboard-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .stats-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.5rem;
        }

        .stats-icon {
            width: 3rem;
            height: 3rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .stats-content {
            flex: 1;
        }

        .stats-label {
            font-size: 0.875rem;
            color: var(--gray);
        }

        .stats-value {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .category-card {
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .category-bg {
            height: 120px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: flex-end;
        }

        .category-overlay {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            color: white;
        }

        .category-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .category-progress {
            height: 4px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            margin-top: 0.5rem;
        }

        .category-progress-fill {
            height: 100%;
            background-color: white;
            border-radius: 2px;
        }

        /* Topic Styles */
        .topic-card {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .topic-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .topic-title {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .topic-status {
            font-size: 0.875rem;
        }

        .topic-status.completed {
            color: var(--success);
        }

        .topic-status.in-progress {
            color: var(--warning);
        }

        .topic-status.not-started {
            color: var(--gray);
        }

        .topic-description {
            color: var(--gray);
            margin-bottom: 1rem;
            flex: 1;
        }

        .topic-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Exercise Styles */
        .exercise-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .exercise-question {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
        }

        .exercise-options {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .exercise-option {
            padding: 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .exercise-option:hover {
            border-color: var(--primary);
        }

        .exercise-option.selected {
            background-color: rgba(67, 97, 238, 0.1);
            border-color: var(--primary);
        }

        .exercise-option.correct {
            background-color: rgba(76, 201, 240, 0.1);
            border-color: var(--success);
        }

        .exercise-option.incorrect {
            background-color: rgba(247, 37, 133, 0.1);
            border-color: var(--danger);
        }

        .exercise-feedback {
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .exercise-feedback.correct {
            background-color: rgba(76, 201, 240, 0.1);
            border-left: 4px solid var(--success);
        }

        .exercise-feedback.incorrect {
            background-color: rgba(247, 37, 133, 0.1);
            border-left: 4px solid var(--danger);
        }

        .exercise-navigation {
            display: flex;
            justify-content: space-between;
        }

        /* AI Assistant Styles */
        .assistant-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 100;
        }

        .assistant-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            border: none;
        }

        .assistant-chat {
            position: absolute;
            bottom: 80px;
            right: 0;
            width: 350px;
            max-height: 500px;
            background-color: var(--card-bg);
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .assistant-header {
            padding: 1rem;
            background-color: var(--primary);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .assistant-title {
            font-weight: 600;
        }

        .assistant-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.25rem;
            cursor: pointer;
        }

        .assistant-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .assistant-message {
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 0.75rem;
            max-width: 80%;
        }

        .assistant-message.user {
            background-color: var(--primary);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 0.25rem;
        }

        .assistant-message.bot {
            background-color: var(--border);
            margin-right: auto;
            border-bottom-left-radius: 0.25rem;
        }

        .assistant-input {
            display: flex;
            padding: 1rem;
            border-top: 1px solid var(--border);
        }

        .assistant-input-field {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            margin-right: 0.5rem;
        }

        .assistant-send {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Responsive Styles */
        @media (max-width: 1024px) {
            .grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                top: 0;
                left: 0;
                height: 100vh;
                z-index: 90;
                background-color: var(--bg);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .navbar-menu {
                display: block;
            }

            .grid-cols-2, .grid-cols-3, .grid-cols-4 {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .auth-card {
                padding: 1.5rem;
            }

            .assistant-chat {
                width: 300px;
            }
        }

        /* Dark mode toggle */
        .theme-toggle {
            position: relative;
            width: 50px;
            height: 24px;
        }

        .theme-toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--gray);
            transition: .4s;
            border-radius: 24px;
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .theme-slider {
            background-color: var(--primary);
        }

        input:checked + .theme-slider:before {
            transform: translateX(26px);
        }

        /* Animations toggle */
        .animations-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .animations-toggle input {
            width: 16px;
            height: 16px;
        }

        /* Settings dropdown */
        .settings-dropdown {
            position: relative;
        }

        .settings-menu {
            position: absolute;
            right: 0;
            top: 100%;
            background-color: var(--card-bg);
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 0.5rem;
            min-width: 200px;
            z-index: 10;
        }

        .settings-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
        }

        .settings-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
        }

        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(67, 97, 238, 0.2);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Streak tracker */
        .streak-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .streak-count {
            font-weight: 600;
            color: var(--warning);
        }

        .streak-icon {
            color: var(--warning);
        }

        /* XP level indicator */
        .level-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .level-badge {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        /* Confetti effect */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: var(--primary);
            top: -10px;
            z-index: 999;
        }

        /* Video player */
        .video-player {
            width: 100%;
            aspect-ratio: 16/9;
            background-color: var(--dark);
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .video-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            background-color: var(--gray-dark);
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // App State Management
        const AppState = (() => {
            let state = {
                currentPage: 'signin',
                user: null,
                learningStyle: null,
                currentCategory: null,
                currentTopic: null,
                currentExercise: 0,
                darkMode: false,
                animationsEnabled: true,
                assistantOpen: false,
                sidebarOpen: false,
                streak: 3,
                xp: 1250,
                level: 5,
                language: 'ro',
                messages: []
            };

            const subscribers = [];

            const getState = () => state;

            const setState = (newState) => {
                state = { ...state, ...newState };
                subscribers.forEach(subscriber => subscriber(state));
                saveToLocalStorage();
            };

            const subscribe = (callback) => {
                subscribers.push(callback);
                return () => {
                    const index = subscribers.indexOf(callback);
                    if (index > -1) {
                        subscribers.splice(index, 1);
                    }
                };
            };

            const loadFromLocalStorage = () => {
                const savedState = localStorage.getItem('learnzyState');
                if (savedState) {
                    state = JSON.parse(savedState);
                }
            };

            const saveToLocalStorage = () => {
                localStorage.setItem('learnzyState', JSON.stringify(state));
            };

            // Initialize
            loadFromLocalStorage();

            return {
                getState,
                setState,
                subscribe
            };
        })();

        // Mock Data
        const mockUsers = [
            { id: 1, email: 'student@example.com', password: 'password123', name: 'Alexandru Popescu' }
        ];

        const learningStyles = {
            visual: {
                name: 'Învățare Vizuală',
                description: 'Înveți cel mai bine prin ajutoare vizuale cum ar fi diagrame, grafice și culori. LearnZy va oferi mai multe explicații vizuale și reprezentări grafice ale conceptelor matematice.',
                icon: 'far fa-eye'
            },
            auditory: {
                name: 'Învățare Auditivă',
                description: 'Înveți cel mai bine prin ascultare și explicații verbale. LearnZy se va concentra pe explicații audio și descrieri verbale ale conceptelor matematice.',
                icon: 'far fa-comment-dots'
            },
            kinesthetic: {
                name: 'Învățare Kinestetică',
                description: 'Înveți cel mai bine prin activități practice și mișcare. LearnZy va oferi exerciții interactive și aplicații practice ale conceptelor matematice.',
                icon: 'far fa-hand-paper'
            },
            logical: {
                name: 'Învățare Logică/Matematică',
                description: 'Înveți cel mai bine prin raționament logic și gândire sistematică. LearnZy va pune accent pe strategii de rezolvare a problemelor și explicații logice pas cu pas.',
                icon: 'far fa-brain'
            }
        };

        const quizQuestions = [
            {
                id: 1,
                question: 'Când învăț ceva nou, prefer:',
                options: [
                    { text: 'Să văd diagrame sau imagini', style: 'visual' },
                    { text: 'Să ascult o explicație', style: 'auditory' },
                    { text: 'Să fac cu mâinile mele', style: 'kinesthetic' },
                    { text: 'Să împart în pași', style: 'logical' }
                ]
            },
            {
                id: 2,
                question: 'Îmi amintesc cel mai bine când:',
                options: [
                    { text: 'Văd informația vizual', style: 'visual' },
                    { text: 'O aud explicată', style: 'auditory' },
                    { text: 'O încerc eu însumi', style: 'kinesthetic' },
                    { text: 'O analizez logic', style: 'logical' }
                ]
            },
            {
                id: 3,
                question: 'Îmi plac lecțiile care:',
                options: [
                    { text: 'Folosesc animații sau desene', style: 'visual' },
                    { text: 'Includ explicații verbale', style: 'auditory' },
                    { text: 'Permit experimente practice', style: 'kinesthetic' },
                    { text: 'Se concentrează pe rezolvarea problemelor', style: 'logical' }
                ]
            },
            {
                id: 4,
                question: 'În clasă, prefer:',
                options: [
                    { text: 'Să urmăresc o demonstrație sau slide-uri', style: 'visual' },
                    { text: 'Să ascult profesorul', style: 'auditory' },
                    { text: 'Exerciții în grup sau proiecte', style: 'kinesthetic' },
                    { text: 'Explicații logice', style: 'logical' }
                ]
            },
            {
                id: 5,
                question: 'Pentru teme, de obicei:',
                options: [
                    { text: 'Fac notițe sau schițe', style: 'visual' },
                    { text: 'Citesc cu voce tare sau folosesc cărți audio', style: 'auditory' },
                    { text: 'Folosesc flashcard-uri sau construiesc modele', style: 'kinesthetic' },
                    { text: 'Rezolv probleme sau puzzle-uri suplimentare', style: 'logical' }
                ]
            },
            {
                id: 6,
                question: 'Materiile mele preferate sunt:',
                options: [
                    { text: 'Arta / Geografie', style: 'visual' },
                    { text: 'Muzică / Literatură', style: 'auditory' },
                    { text: 'Educație fizică / Științe experimentale', style: 'kinesthetic' },
                    { text: 'Matematică / Fizică', style: 'logical' }
                ]
            },
            {
                id: 7,
                question: 'Îmi este mai ușor să învăț când:',
                options: [
                    { text: 'Pot vizualiza conținutul', style: 'visual' },
                    { text: 'Aud pe cineva explicând', style: 'auditory' },
                    { text: 'Pot interacționa cu el', style: 'kinesthetic' },
                    { text: 'Pot găsi modele sau logică', style: 'logical' }
                ]
            }
        ];

        const categories = [
            {
                id: 1,
                name: 'Algebră',
                description: 'Stăpânește elementele de bază ale expresiilor, ecuațiilor și funcțiilor algebrice.',
                progress: 65,
                topics: [
                    {
                        id: 1,
                        name: 'Ecuații Liniare',
                        description: 'Rezolvă ecuații de gradul întâi cu o variabilă.',
                        completed: true,
                        exercises: [
                            {
                                id: 1,
                                question: 'Rezolvă pentru x: 2x + 5 = 15',
                                options: ['x = 5', 'x = 7', 'x = 10', 'x = 12'],
                                answer: 0,
                                explanation: 'Scădem 5 din ambele părți: 2x = 10. Apoi împărțim ambele părți la 2: x = 5.'
                            },
                            {
                                id: 2,
                                question: 'Care dintre acestea este o ecuație liniară?',
                                options: ['x² + 2x + 1 = 0', '3x - 7 = 2', 'y = √x', 'x³ = 8'],
                                answer: 1,
                                explanation: 'O ecuație liniară are variabile cu exponentul 1. 3x - 7 = 2 este singura opțiune care se potrivește.'
                            }
                        ]
                    },
                    {
                        id: 2,
                        name: 'Ecuații Patratice',
                        description: 'Rezolvă ecuații polinomiale de gradul doi folosind diverse metode.',
                        completed: true,
                        exercises: [
                            {
                                id: 1,
                                question: 'Care sunt soluțiile ecuației x² - 5x + 6 = 0?',
                                options: ['x = 2 și x = 3', 'x = 1 și x = 6', 'x = -2 și x = -3', 'x = 0.5 și x = 6'],
                                answer: 0,
                                explanation: 'Factorizăm ecuația: (x-2)(x-3) = 0. Soluțiile sunt x=2 și x=3.'
                            }
                        ]
                    },
                    {
                        id: 3,
                        name: 'Polinoame',
                        description: 'Înțelege și manipulează expresii polinomiale.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 4,
                        name: 'Funcții',
                        description: 'Explorează diferite tipuri de funcții și proprietățile lor.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 5,
                        name: 'Sisteme de Ecuații',
                        description: 'Rezolvă mai multe ecuații cu mai multe variabile.',
                        completed: false,
                        exercises: []
                    }
                ]
            },
            {
                id: 2,
                name: 'Geometrie',
                description: 'Explorează forme, dimensiuni și proprietăți ale figurilor în spațiu.',
                progress: 30,
                topics: [
                    {
                        id: 1,
                        name: 'Geometrie de Bază',
                        description: 'Învață despre puncte, linii, unghiuri și plane.',
                        completed: true,
                        exercises: []
                    },
                    {
                        id: 2,
                        name: 'Triunghiuri',
                        description: 'Studiază proprietăți și teoreme legate de triunghiuri.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 3,
                        name: 'Cercuri',
                        description: 'Înțelege teoremele și proprietățile cercurilor.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 4,
                        name: 'Poligoane',
                        description: 'Explorează proprietățile formelor cu mai multe laturi.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 5,
                        name: 'Geometrie Solidă',
                        description: 'Studiază forme tridimensionale și proprietățile lor.',
                        completed: false,
                        exercises: []
                    }
                ]
            },
            {
                id: 3,
                name: 'Trigonometrie',
                description: 'Descoperă relații între unghiuri și laturi ale triunghiurilor.',
                progress: 10,
                topics: [
                    {
                        id: 1,
                        name: 'Rapoarte Trigonometrice',
                        description: 'Învață despre funcțiile sinus, cosinus și tangentă.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 2,
                        name: 'Cercul Trigonometric',
                        description: 'Înțelege relația dintre unghiuri și coordonate.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 3,
                        name: 'Identități Trigonometrice',
                        description: 'Stăpânește identitățile trigonometrice fundamentale.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 4,
                        name: 'Grafice ale Funcțiilor Trigonometrice',
                        description: 'Vizualizează și analizează funcții trigonometrice.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 5,
                        name: 'Ecuații Trigonometrice',
                        description: 'Rezolvă ecuații care implică funcții trigonometrice.',
                        completed: false,
                        exercises: []
                    }
                ]
            },
            {
                id: 4,
                name: 'Calcul',
                description: 'Aprofundează-te în matematica schimbării și mișcării.',
                progress: 5,
                topics: [
                    {
                        id: 1,
                        name: 'Limite',
                        description: 'Înțelege conceptul fundamental al limitelor.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 2,
                        name: 'Derivate',
                        description: 'Învață despre rate de schimbare și pante ale curbelor.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 3,
                        name: 'Integrale',
                        description: 'Descoperă matematica acumulării și ariei.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 4,
                        name: 'Aplicații ale Derivării',
                        description: 'Aplică derivatele la probleme din viața reală.',
                        completed: false,
                        exercises: []
                    },
                    {
                        id: 5,
                        name: 'Aplicații ale Integralei',
                        description: 'Aplică integralele pentru a rezolva probleme practice.',
                        completed: false,
                        exercises: []
                    }
                ]
            }
        ];

        const badges = [
            { id: 1, name: 'Învățare Rapidă', description: 'Finalizează 5 exerciții într-o singură zi', earned: true },
            { id: 2, name: 'Maestru în Algebră', description: 'Finalizează toate subiectele de Algebră', earned: false },
            { id: 3, name: 'Șir de 7 Zile', description: 'Exersează timp de 7 zile consecutive', earned: false },
            { id: 4, name: 'Gânditor Rapid', description: 'Rezolvă corect 10 exerciții la rând', earned: true }
        ];

        // Mock API Functions
        const mockAPI = {
            login: (email, password) => {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        const user = mockUsers.find(u => u.email === email && u.password === password);
                        if (user) {
                            resolve({ success: true, user });
                        } else {
                            reject({ success: false, message: 'Email sau parolă invalidă' });
                        }
                    }, 1000);
                });
            },
            
            submitLearningStyle: (style) => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({ success: true, style });
                    }, 500);
                });
            },
            
            getMathContent: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({ success: true, categories });
                    }, 500);
                });
            },
            
            getBadges: () => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({ success: true, badges });
                    }, 500);
                });
            },
            
            aiAssistant: (message) => {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const responses = {
                            'salut': 'Salut! Cu ce te pot ajuta la matematică astăzi?',
                            'ajutor': 'Pot explica concepte matematice, ajuta cu exerciții sau oferi exemple. De ce ai nevoie?',
                            'explica ecuații patratice': 'O ecuație pătratică este orice ecuație care poate fi aranjată în forma standard ca ax² + bx + c = 0. Poți să o rezolvi prin factorizare, completarea pătratului sau folosind formula pătratică.',
                            'default': 'Sunt aici să te ajut cu întrebările tale de matematică. Poți fi mai specific despre ce ai nevoie?'
                        };
                        
                        const lowerMessage = message.toLowerCase();
                        let response = responses.default;
                        
                        if (lowerMessage.includes('salut') || lowerMessage.includes('bună')) {
                            response = responses.salut;
                        } else if (lowerMessage.includes('ajutor')) {
                            response = responses.ajutor;
                        } else if (lowerMessage.includes('pătratic') || lowerMessage.includes('patratic')) {
                            response = responses['explica ecuații patratice'];
                        }
                        
                        resolve({ success: true, response });
                    }, 800);
                });
            },

            signup: (userData) => {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        const userExists = mockUsers.some(u => u.email === userData.email);
                        if (userExists) {
                            reject({ success: false, message: 'Email deja înregistrat' });
                        } else {
                            const newUser = {
                                id: mockUsers.length + 1,
                                ...userData
                            };
                            mockUsers.push(newUser);
                            resolve({ success: true, user: newUser });
                        }
                    }, 1000);
                });
            }
        };

        // Utility Functions
        const Utils = {
            createElement: (tag, className, text) => {
                const element = document.createElement(tag);
                if (className) element.className = className;
                if (text) element.textContent = text;
                return element;
            },
            
            createElementWithHTML: (html) => {
                const template = document.createElement('template');
                template.innerHTML = html.trim();
                return template.content.firstChild;
            },
            
            addClass: (element, className) => {
                element.classList.add(className);
            },
            
            removeClass: (element, className) => {
                element.classList.remove(className);
            },
            
            toggleClass: (element, className) => {
                element.classList.toggle(className);
            },
            
            createConfetti: () => {
                const colors = ['#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#f72585'];
                const confettiContainer = document.createElement('div');
                confettiContainer.style.position = 'fixed';
                confettiContainer.style.top = '0';
                confettiContainer.style.left = '0';
                confettiContainer.style.width = '100%';
                confettiContainer.style.height = '100%';
                confettiContainer.style.pointerEvents = 'none';
                confettiContainer.style.zIndex = '1000';
                
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.width = `${Math.random() * 10 + 5}px`;
                    confetti.style.height = `${Math.random() * 10 + 5}px`;
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    
                    const animationDuration = Math.random() * 3 + 2;
                    confetti.style.animation = `fall ${animationDuration}s linear forwards`;
                    
                    const keyframes = `
                        @keyframes fall {
                            to {
                                transform: translateY(100vh) rotate(${Math.random() * 360}deg);
                            }
                        }
                    `;
                    
                    const style = document.createElement('style');
                    style.innerHTML = keyframes;
                    document.head.appendChild(style);
                    
                    confettiContainer.appendChild(confetti);
                }
                
                document.body.appendChild(confettiContainer);
                
                setTimeout(() => {
                    document.body.removeChild(confettiContainer);
                }, 3000);
            }
        };

        // Components
        const SignInPage = (() => {
            const render = () => {
                const container = Utils.createElement('div', 'auth-container animate-fade');
                
                const card = Utils.createElement('div', 'auth-card');
                
                const header = Utils.createElement('div', 'auth-header');
                const logo = Utils.createElement('div', 'auth-logo', 'LearnZy');
                const title = Utils.createElement('h1', 'auth-title', 'Bine ai revenit!');
                const subtitle = Utils.createElement('p', 'auth-subtitle', 'Conectează-te pentru a-ți continua călătoria în învățarea matematicii');
                
                header.appendChild(logo);
                header.appendChild(title);
                header.appendChild(subtitle);
                
                const form = Utils.createElement('form', 'flex flex-col gap-3');
                form.id = 'signin-form';
                
                const emailGroup = Utils.createElement('div', 'input-group');
                const emailLabel = Utils.createElement('label', 'input-label', 'Email');
                emailLabel.htmlFor = 'email';
                const emailInput = Utils.createElement('input', 'input-field');
                emailInput.type = 'email';
                emailInput.id = 'email';
                emailInput.placeholder = 'email@dvs.com';
                emailInput.required = true;
                
                emailGroup.appendChild(emailLabel);
                emailGroup.appendChild(emailInput);
                
                const passwordGroup = Utils.createElement('div', 'input-group');
                const passwordLabel = Utils.createElement('label', 'input-label', 'Parolă');
                passwordLabel.htmlFor = 'password';
                const passwordInput = Utils.createElement('input', 'input-field');
                passwordInput.type = 'password';
                passwordInput.id = 'password';
                passwordInput.placeholder = '••••••••';
                passwordInput.required = true;
                
                passwordGroup.appendChild(passwordLabel);
                passwordGroup.appendChild(passwordInput);
                
                const errorAlert = Utils.createElement('div', 'alert alert-error hidden');
                errorAlert.id = 'error-alert';
                
                const submitButton = Utils.createElement('button', 'btn btn-primary', 'Conectează-te');
                submitButton.type = 'submit';
                
                form.appendChild(errorAlert);
                form.appendChild(emailGroup);
                form.appendChild(passwordGroup);
                form.appendChild(submitButton);
                
                // Add signup link
                const signupLink = Utils.createElement('div', 'text-center mt-4');
                const signupText = Utils.createElement('span', 'text-sm', 'Nu ai un cont? ');
                const signupAnchor = Utils.createElement('a', 'text-primary cursor-pointer', 'Înregistrează-te');
                signupAnchor.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'signup' });
                });
                
                signupLink.appendChild(signupText);
                signupLink.appendChild(signupAnchor);
                card.appendChild(signupLink);
                
                card.appendChild(header);
                card.appendChild(form);
                container.appendChild(card);
                
                form.addEventListener('submit', handleSubmit);
                
                return container;
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                
                const form = e.target;
                const email = form.querySelector('#email').value;
                const password = form.querySelector('#password').value;
                const errorAlert = form.querySelector('#error-alert');
                
                try {
                    const response = await mockAPI.login(email, password);
                    
                    if (response.success) {
                        AppState.setState({ 
                            user: response.user,
                            currentPage: 'learning-style'
                        });
                    }
                } catch (error) {
                    errorAlert.textContent = error.message;
                    Utils.removeClass(errorAlert, 'hidden');
                    
                    setTimeout(() => {
                        Utils.addClass(errorAlert, 'hidden');
                    }, 3000);
                }
            };
            
            return { render };
        })();

        const SignUpPage = (() => {
            const render = () => {
                const container = Utils.createElement('div', 'auth-container animate-fade');
                
                const card = Utils.createElement('div', 'auth-card');
                
                const header = Utils.createElement('div', 'auth-header');
                const logo = Utils.createElement('div', 'auth-logo', 'LearnZy');
                const title = Utils.createElement('h1', 'auth-title', 'Creează Cont');
                const subtitle = Utils.createElement('p', 'auth-subtitle', 'Alătură-te LearnZy pentru a-ți începe călătoria personalizată în matematică');
                
                header.appendChild(logo);
                header.appendChild(title);
                header.appendChild(subtitle);
                
                const form = Utils.createElement('form', 'flex flex-col gap-3');
                form.id = 'signup-form';
                
                // Name field
                const nameGroup = Utils.createElement('div', 'input-group');
                const nameLabel = Utils.createElement('label', 'input-label', 'Nume complet');
                nameLabel.htmlFor = 'name';
                const nameInput = Utils.createElement('input', 'input-field');
                nameInput.type = 'text';
                nameInput.id = 'name';
                nameInput.placeholder = 'Alexandru Popescu';
                nameInput.required = true;
                
                nameGroup.appendChild(nameLabel);
                nameGroup.appendChild(nameInput);
                
                // Email field
                const emailGroup = Utils.createElement('div', 'input-group');
                const emailLabel = Utils.createElement('label', 'input-label', 'Email');
                emailLabel.htmlFor = 'email';
                const emailInput = Utils.createElement('input', 'input-field');
                emailInput.type = 'email';
                emailInput.id = 'email';
                emailInput.placeholder = 'email@dvs.com';
                emailInput.required = true;
                
                emailGroup.appendChild(emailLabel);
                emailGroup.appendChild(emailInput);
                
                // Password field
                const passwordGroup = Utils.createElement('div', 'input-group');
                const passwordLabel = Utils.createElement('label', 'input-label', 'Parolă');
                passwordLabel.htmlFor = 'password';
                const passwordInput = Utils.createElement('input', 'input-field');
                passwordInput.type = 'password';
                passwordInput.id = 'password';
                passwordInput.placeholder = '••••••••';
                passwordInput.required = true;
                passwordInput.minLength = 8;
                
                passwordGroup.appendChild(passwordLabel);
                passwordGroup.appendChild(passwordInput);
                
                // Confirm Password field
                const confirmGroup = Utils.createElement('div', 'input-group');
                const confirmLabel = Utils.createElement('label', 'input-label', 'Confirmă parola');
                confirmLabel.htmlFor = 'confirm';
                const confirmInput = Utils.createElement('input', 'input-field');
                confirmInput.type = 'password';
                confirmInput.id = 'confirm';
                confirmInput.placeholder = '••••••••';
                confirmInput.required = true;
                
                confirmGroup.appendChild(confirmLabel);
                confirmGroup.appendChild(confirmInput);
                
                // Grade level selection
                const gradeGroup = Utils.createElement('div', 'input-group');
                const gradeLabel = Utils.createElement('label', 'input-label', 'Clasă');
                gradeLabel.htmlFor = 'grade';
                const gradeSelect = Utils.createElement('select', 'input-field');
                gradeSelect.id = 'grade';
                
                const grades = [
                    'Clasa a 9-a',
                    'Clasa a 10-a',
                    'Clasa a 11-a',
                    'Clasa a 12-a'
                ];
                
                grades.forEach(grade => {
                    const option = Utils.createElement('option', null, grade);
                    option.value = grade;
                    gradeSelect.appendChild(option);
                });
                
                gradeGroup.appendChild(gradeLabel);
                gradeGroup.appendChild(gradeSelect);
                
                // Terms checkbox
                const termsGroup = Utils.createElement('div', 'flex items-center gap-2');
                const termsCheck = Utils.createElement('input');
                termsCheck.type = 'checkbox';
                termsCheck.id = 'terms';
                termsCheck.required = true;
                const termsLabel = Utils.createElement('label', null, 'Sunt de acord cu Termenii și Politica de Confidențialitate');
                termsLabel.htmlFor = 'terms';
                termsLabel.style.fontSize = '0.875rem';
                
                termsGroup.appendChild(termsCheck);
                termsGroup.appendChild(termsLabel);
                
                const errorAlert = Utils.createElement('div', 'alert alert-error hidden');
                errorAlert.id = 'error-alert';
                
                const submitButton = Utils.createElement('button', 'btn btn-primary', 'Creează Cont');
                submitButton.type = 'submit';
                
                form.appendChild(errorAlert);
                form.appendChild(nameGroup);
                form.appendChild(emailGroup);
                form.appendChild(passwordGroup);
                form.appendChild(confirmGroup);
                form.appendChild(gradeGroup);
                form.appendChild(termsGroup);
                form.appendChild(submitButton);
                
                // Login link
                const loginLink = Utils.createElement('div', 'text-center mt-4');
                const loginText = Utils.createElement('span', 'text-sm', 'Ai deja un cont? ');
                const loginAnchor = Utils.createElement('a', 'text-primary cursor-pointer', 'Conectează-te');
                loginAnchor.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'signin' });
                });
                
                loginLink.appendChild(loginText);
                loginLink.appendChild(loginAnchor);
                
                card.appendChild(header);
                card.appendChild(form);
                card.appendChild(loginLink);
                container.appendChild(card);
                
                form.addEventListener('submit', handleSubmit);
                
                return container;
            };
            
            const handleSubmit = async (e) => {
                e.preventDefault();
                
                const form = e.target;
                const name = form.querySelector('#name').value;
                const email = form.querySelector('#email').value;
                const password = form.querySelector('#password').value;
                const confirm = form.querySelector('#confirm').value;
                const grade = form.querySelector('#grade').value;
                const errorAlert = form.querySelector('#error-alert');
                
                // Validation
                if (password !== confirm) {
                    errorAlert.textContent = 'Parolele nu coincid';
                    Utils.removeClass(errorAlert, 'hidden');
                    return;
                }
                
                if (password.length < 8) {
                    errorAlert.textContent = 'Parola trebuie să aibă cel puțin 8 caractere';
                    Utils.removeClass(errorAlert, 'hidden');
                    return;
                }
                
                // Check if user already exists
                const userExists = mockUsers.some(u => u.email === email);
                if (userExists) {
                    errorAlert.textContent = 'Email deja înregistrat';
                    Utils.removeClass(errorAlert, 'hidden');
                    return;
                }
                
                try {
                    const response = await mockAPI.signup({
                        name,
                        email,
                        password,
                        grade
                    });
                    
                    if (response.success) {
                        AppState.setState({ 
                            user: response.user,
                            currentPage: 'learning-style'
                        });
                    }
                } catch (error) {
                    errorAlert.textContent = error.message;
                    Utils.removeClass(errorAlert, 'hidden');
                }
            };
            
            return { render };
        })();

        const LearningStylePage = (() => {
            let currentQuestion = 0;
            const answers = [];
            
            const render = () => {
                const container = Utils.createElement('div', 'quiz-container animate-fade');
                
                const progress = Utils.createElement('div', 'quiz-progress');
                const progressText = Utils.createElement('p', 'text-center', `Întrebarea ${currentQuestion + 1} din ${quizQuestions.length}`);
                const progressBar = Utils.createElement('div', 'progress-bar');
                const progressFill = Utils.createElement('div', 'progress-fill');
                progressFill.style.width = `${((currentQuestion + 1) / quizQuestions.length) * 100}%`;
                
                progressBar.appendChild(progressFill);
                progress.appendChild(progressText);
                progress.appendChild(progressBar);
                
                const questionContainer = Utils.createElement('div', 'quiz-question');
                const questionText = Utils.createElement('h2', 'quiz-question-text', quizQuestions[currentQuestion].question);
                
                const optionsContainer = Utils.createElement('div', 'flex flex-col gap-2');
                quizQuestions[currentQuestion].options.forEach((option, index) => {
                    const optionElement = Utils.createElement('div', 'quiz-option');
                    optionElement.textContent = option.text;
                    optionElement.dataset.index = index;
                    
                    if (answers[currentQuestion] === index) {
                        Utils.addClass(optionElement, 'selected');
                    }
                    
                    optionElement.addEventListener('click', () => selectOption(optionElement, index));
                    optionsContainer.appendChild(optionElement);
                });
                
                questionContainer.appendChild(questionText);
                questionContainer.appendChild(optionsContainer);
                
                const navigation = Utils.createElement('div', 'quiz-navigation');
                
                const prevButton = Utils.createElement('button', 'btn btn-outline', 'Anterior');
                prevButton.type = 'button';
                if (currentQuestion === 0) {
                    prevButton.disabled = true;
                }
                prevButton.addEventListener('click', goToPreviousQuestion);
                
                const nextButton = Utils.createElement('button', 'btn btn-primary', currentQuestion === quizQuestions.length - 1 ? 'Trimite' : 'Următorul');
                nextButton.type = 'button';
                if (answers[currentQuestion] === undefined) {
                    nextButton.disabled = true;
                }
                nextButton.addEventListener('click', goToNextQuestion);
                
                navigation.appendChild(prevButton);
                navigation.appendChild(nextButton);
                
                container.appendChild(progress);
                container.appendChild(questionContainer);
                container.appendChild(navigation);
                
                return container;
            };
            
            const selectOption = (element, index) => {
                const options = element.parentElement.querySelectorAll('.quiz-option');
                options.forEach(opt => Utils.removeClass(opt, 'selected'));
                Utils.addClass(element, 'selected');
                
                answers[currentQuestion] = index;
                
                const nextButton = document.querySelector('.quiz-navigation .btn-primary');
                if (nextButton) {
                    nextButton.disabled = false;
                }
            };
            
            const goToPreviousQuestion = () => {
                if (currentQuestion > 0) {
                    currentQuestion--;
                    AppState.setState({ currentPage: 'learning-style' });
                }
            };
            
            const goToNextQuestion = async () => {
                if (currentQuestion < quizQuestions.length - 1) {
                    currentQuestion++;
                    AppState.setState({ currentPage: 'learning-style' });
                } else {
                    // Calculate learning style
                    const styleCounts = {
                        visual: 0,
                        auditory: 0,
                        kinesthetic: 0,
                        logical: 0
                    };
                    
                    answers.forEach((answerIndex, questionIndex) => {
                        const selectedOption = quizQuestions[questionIndex].options[answerIndex];
                        styleCounts[selectedOption.style]++;
                    });
                    
                    let maxStyle = 'visual';
                    let maxCount = 0;
                    
                    for (const [style, count] of Object.entries(styleCounts)) {
                        if (count > maxCount) {
                            maxCount = count;
                            maxStyle = style;
                        }
                    }
                    
                    try {
                        await mockAPI.submitLearningStyle(maxStyle);
                        AppState.setState({ 
                            learningStyle: maxStyle,
                            currentPage: 'learning-style-result'
                        });
                    } catch (error) {
                        console.error('Eroare la trimiterea stilului de învățare:', error);
                    }
                }
            };
            
            return { render };
        })();

        const LearningStyleResultPage = (() => {
            const render = () => {
                const state = AppState.getState();
                const style = learningStyles[state.learningStyle];
                
                const container = Utils.createElement('div', 'flex flex-col items-center justify-center h-screen animate-fade');
                
                const card = Utils.createElement('div', 'card text-center p-8 max-w-md');
                
                const icon = Utils.createElement('i', `${style.icon} text-6xl text-primary mb-4`);
                
                const title = Utils.createElement('h1', 'text-2xl font-bold mb-2', `Ești un învățător ${style.name}!`);
                
                const description = Utils.createElement('p', 'text-gray-600 mb-6', style.description);
                
                const continueButton = Utils.createElement('button', 'btn btn-primary', 'Continuă către Panoul Principal');
                continueButton.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'dashboard' });
                });
                
                card.appendChild(icon);
                card.appendChild(title);
                card.appendChild(description);
                card.appendChild(continueButton);
                
                container.appendChild(card);
                
                return container;
            };
            
            return { render };
        })();

        const Navbar = (() => {
            const render = () => {
                const state = AppState.getState();
                const navbar = Utils.createElement('nav', 'navbar shadow');
                
                const leftSection = Utils.createElement('div', 'flex items-center gap-4');
                
                const menuButton = Utils.createElement('button', 'btn btn-ghost navbar-menu');
                const menuIcon = Utils.createElement('i', 'fas fa-bars');
                menuButton.appendChild(menuIcon);
                menuButton.addEventListener('click', () => {
                    AppState.setState({ sidebarOpen: !state.sidebarOpen });
                });
                
                const logo = Utils.createElement('div', 'text-xl font-bold text-primary', 'LearnZy');
                logo.style.cursor = 'pointer';
                logo.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'dashboard' });
                });
                
                leftSection.appendChild(menuButton);
                leftSection.appendChild(logo);
                
                const rightSection = Utils.createElement('div', 'flex items-center gap-4');
                
                // Streak display
                const streakContainer = Utils.createElement('div', 'streak-container tooltip');
                const streakIcon = Utils.createElement('i', 'fas fa-fire streak-icon');
                const streakCount = Utils.createElement('span', 'streak-count', `${state.streak}z`);
                
                const streakTooltip = Utils.createElement('span', 'tooltip-text', `Șir curent: ${state.streak} zile`);
                streakTooltip.style.whiteSpace = 'nowrap';
                
                streakContainer.appendChild(streakIcon);
                streakContainer.appendChild(streakCount);
                streakContainer.appendChild(streakTooltip);
                
                // XP and level display
                const levelContainer = Utils.createElement('div', 'level-indicator tooltip');
                const levelBadge = Utils.createElement('div', 'level-badge', state.level);
                const xpText = Utils.createElement('span', null, `${state.xp} XP`);
                
                const levelTooltip = Utils.createElement('span', 'tooltip-text', `Nivel ${state.level} - ${state.xp} XP`);
                levelTooltip.style.whiteSpace = 'nowrap';
                
                levelContainer.appendChild(levelBadge);
                levelContainer.appendChild(xpText);
                levelContainer.appendChild(levelTooltip);
                
                // Settings dropdown
                const settingsDropdown = Utils.createElement('div', 'settings-dropdown');
                const settingsButton = Utils.createElement('button', 'btn btn-ghost');
                const settingsIcon = Utils.createElement('i', 'fas fa-cog');
                settingsButton.appendChild(settingsIcon);
                
                const settingsMenu = Utils.createElement('div', 'settings-menu shadow hidden');
                
                // Dark mode toggle
                const darkModeItem = Utils.createElement('div', 'settings-item');
                const darkModeLabel = Utils.createElement('span', null, 'Mod Întunecat');
                const darkModeToggle = Utils.createElement('label', 'theme-toggle');
                const darkModeInput = Utils.createElement('input');
                darkModeInput.type = 'checkbox';
                darkModeInput.checked = state.darkMode;
                darkModeInput.addEventListener('change', (e) => {
                    AppState.setState({ darkMode: e.target.checked });
                    document.body.setAttribute('data-theme', e.target.checked ? 'dark' : 'light');
                });
                
                const darkModeSlider = Utils.createElement('span', 'theme-slider');
                darkModeToggle.appendChild(darkModeInput);
                darkModeToggle.appendChild(darkModeSlider);
                
                darkModeItem.appendChild(darkModeLabel);
                darkModeItem.appendChild(darkModeToggle);
                
                // Animations toggle
                const animationsItem = Utils.createElement('div', 'settings-item');
                const animationsLabel = Utils.createElement('span', null, 'Animații');
                const animationsToggle = Utils.createElement('input');
                animationsToggle.type = 'checkbox';
                animationsToggle.checked = state.animationsEnabled;
                animationsToggle.addEventListener('change', (e) => {
                    AppState.setState({ animationsEnabled: e.target.checked });
                });
                
                animationsItem.appendChild(animationsLabel);
                animationsItem.appendChild(animationsToggle);
                
                // Language selector
                const languageItem = Utils.createElement('div', 'settings-item');
                const languageLabel = Utils.createElement('span', null, 'Limbă');
                const languageSelect = Utils.createElement('select');
                const englishOption = Utils.createElement('option', null, 'English');
                englishOption.value = 'en';
                const romanianOption = Utils.createElement('option', null, 'Română');
                romanianOption.value = 'ro';
                
                languageSelect.appendChild(englishOption);
                languageSelect.appendChild(romanianOption);
                languageSelect.value = state.language;
                languageSelect.addEventListener('change', (e) => {
                    AppState.setState({ language: e.target.value });
                });
                
                languageItem.appendChild(languageLabel);
                languageItem.appendChild(languageSelect);
                
                settingsMenu.appendChild(darkModeItem);
                settingsMenu.appendChild(animationsItem);
                settingsMenu.appendChild(languageItem);
                
                settingsButton.addEventListener('click', () => {
                    settingsMenu.classList.toggle('hidden');
                });
                
                document.addEventListener('click', (e) => {
                    if (!settingsDropdown.contains(e.target)) {
                        settingsMenu.classList.add('hidden');
                    }
                });
                
                settingsDropdown.appendChild(settingsButton);
                settingsDropdown.appendChild(settingsMenu);
                
                rightSection.appendChild(streakContainer);
                rightSection.appendChild(levelContainer);
                rightSection.appendChild(settingsDropdown);
                
                navbar.appendChild(leftSection);
                navbar.appendChild(rightSection);
                
                return navbar;
            };
            
            return { render };
        })();

        const Sidebar = (() => {
            const render = () => {
                const state = AppState.getState();
                const sidebar = Utils.createElement('div', `sidebar ${state.sidebarOpen ? 'open' : ''}`);
                
                const navItems = [
                    { icon: 'fas fa-home', text: 'Panou Principal', page: 'dashboard' },
                    { icon: 'fas fa-book', text: 'Cursurile Mele', page: 'courses' },
                    { icon: 'fas fa-trophy', text: 'Realizări', page: 'achievements' },
                    { icon: 'fas fa-chart-line', text: 'Progres', page: 'progress' },
                    { icon: 'fas fa-cog', text: 'Setări', page: 'settings' }
                ];
                
                navItems.forEach(item => {
                    const navItem = Utils.createElement('a', `sidebar-item ${state.currentPage === item.page ? 'active' : ''}`);
                    const icon = Utils.createElement('i', item.icon);
                    const text = Utils.createElement('span', null, item.text);
                    
                    navItem.appendChild(icon);
                    navItem.appendChild(text);
                    
                    navItem.addEventListener('click', () => {
                        AppState.setState({ 
                            currentPage: item.page,
                            sidebarOpen: false
                        });
                    });
                    
                    sidebar.appendChild(navItem);
                });
                
                return sidebar;
            };
            
            return { render };
        })();

        const DashboardPage = (() => {
            const render = () => {
                const state = AppState.getState();
                const container = Utils.createElement('div', 'main-content');
                
                const header = Utils.createElement('div', 'dashboard-header');
                const title = Utils.createElement('h1', 'dashboard-title', 'Panou de Învățare Matematică');
                
                header.appendChild(title);
                container.appendChild(header);
                
                // Welcome message with learning style
                const welcomeCard = Utils.createElement('div', 'card mb-6');
                const welcomeText = Utils.createElement('p', null, `Bine ai revenit, ${state.user?.name || 'Elev'}!`);
                const learningStyleText = Utils.createElement('p', null);
                
                if (state.learningStyle) {
                    const style = learningStyles[state.learningStyle];
                    const styleIcon = Utils.createElement('i', `${style.icon} mr-2`);
                    learningStyleText.appendChild(styleIcon);
                    learningStyleText.appendChild(document.createTextNode(`Stilul tău de învățare: ${style.name}`));
                } else {
                    learningStyleText.textContent = 'Completează evaluarea stilului de învățare pentru a personaliza experiența';
                }
                
                welcomeCard.appendChild(welcomeText);
                welcomeCard.appendChild(learningStyleText);
                container.appendChild(welcomeCard);
                
                // Stats cards
                const statsContainer = Utils.createElement('div', 'grid grid-cols-2 md:grid-cols-4 gap-4 mb-6');
                
                const stats = [
                    { icon: 'fas fa-book', color: 'bg-primary', label: 'Subiecte Începute', value: 4 },
                    { icon: 'fas fa-check-circle', color: 'bg-success', label: 'Subiecte Finalizate', value: 2 },
                    { icon: 'fas fa-star', color: 'bg-warning', label: 'Șir Curent', value: `${state.streak} zile` },
                    { icon: 'fas fa-trophy', color: 'bg-danger', label: 'Insigne Câștigate', value: 2 }
                ];
                
                stats.forEach(stat => {
                    const statCard = Utils.createElement('div', 'stats-card card');
                    
                    const icon = Utils.createElement('div', `stats-icon ${stat.color} text-white`);
                    const iconElement = Utils.createElement('i', stat.icon);
                    icon.appendChild(iconElement);
                    
                    const content = Utils.createElement('div', 'stats-content');
                    const label = Utils.createElement('div', 'stats-label', stat.label);
                    const value = Utils.createElement('div', 'stats-value', stat.value);
                    
                    content.appendChild(label);
                    content.appendChild(value);
                    
                    statCard.appendChild(icon);
                    statCard.appendChild(content);
                    
                    statsContainer.appendChild(statCard);
                });
                
                container.appendChild(statsContainer);
                
                // Categories
                const categoriesTitle = Utils.createElement('h2', 'text-xl font-bold mb-4', 'Categorii de Matematică');
                container.appendChild(categoriesTitle);
                
                const categoriesGrid = Utils.createElement('div', 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6');
                
                categories.forEach(category => {
                    const categoryCard = Utils.createElement('div', 'category-card card');
                    categoryCard.addEventListener('click', () => {
                        AppState.setState({ 
                            currentPage: 'category',
                            currentCategory: category.id
                        });
                    });
                    
                    const bg = Utils.createElement('div', 'category-bg rounded-t-lg');
                    bg.style.backgroundColor = getRandomColor();
                    
                    const overlay = Utils.createElement('div', 'category-overlay');
                    const categoryName = Utils.createElement('h3', 'category-title', category.name);
                    const categoryDesc = Utils.createElement('p', 'text-sm', category.description);
                    
                    const progress = Utils.createElement('div', 'category-progress');
                    const progressFill = Utils.createElement('div', 'category-progress-fill');
                    progressFill.style.width = `${category.progress}%`;
                    
                    progress.appendChild(progressFill);
                    
                    overlay.appendChild(categoryName);
                    overlay.appendChild(categoryDesc);
                    overlay.appendChild(progress);
                    
                    bg.appendChild(overlay);
                    categoryCard.appendChild(bg);
                    
                    categoriesGrid.appendChild(categoryCard);
                });
                
                container.appendChild(categoriesGrid);
                
                // Badges section
                const badgesTitle = Utils.createElement('h2', 'text-xl font-bold mb-4 mt-8', 'Insigne Recente');
                container.appendChild(badgesTitle);
                
                const badgesGrid = Utils.createElement('div', 'grid grid-cols-2 md:grid-cols-4 gap-4');
                
                badges.filter(b => b.earned).slice(0, 4).forEach(badge => {
                    const badgeCard = Utils.createElement('div', 'card p-4 flex flex-col items-center text-center');
                    
                    const badgeIcon = Utils.createElement('i', 'fas fa-trophy text-3xl text-warning mb-2');
                    const badgeName = Utils.createElement('h3', 'font-bold mb-1', badge.name);
                    const badgeDesc = Utils.createElement('p', 'text-sm text-gray-600', badge.description);
                    
                    badgeCard.appendChild(badgeIcon);
                    badgeCard.appendChild(badgeName);
                    badgeCard.appendChild(badgeDesc);
                    
                    badgesGrid.appendChild(badgeCard);
                });
                
                container.appendChild(badgesGrid);
                
                return container;
            };
            
            const getRandomColor = () => {
                const colors = [
                    '#4361ee', '#3f37c9', '#4895ef', '#4cc9f0', '#f72585',
                    '#7209b7', '#560bad', '#480ca8', '#3a0ca3', '#3f37c9'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            };
            
            return { render };
        })();

        const CategoryPage = (() => {
            const render = () => {
                const state = AppState.getState();
                const category = categories.find(c => c.id === state.currentCategory);
                
                if (!category) {
                    AppState.setState({ currentPage: 'dashboard' });
                    return Utils.createElement('div');
                }
                
                const container = Utils.createElement('div', 'main-content');
                
                // Back button
                const backButton = Utils.createElement('button', 'btn btn-ghost mb-4 flex items-center gap-2');
                const backIcon = Utils.createElement('i', 'fas fa-arrow-left');
                const backText = Utils.createElement('span', null, 'Înapoi la Panou');
                
                backButton.appendChild(backIcon);
                backButton.appendChild(backText);
                backButton.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'dashboard' });
                });
                
                container.appendChild(backButton);
                
                // Category header
                const header = Utils.createElement('div', 'flex items-start justify-between mb-6');
                const titleGroup = Utils.createElement('div');
                const title = Utils.createElement('h1', 'text-2xl font-bold mb-2', category.name);
                const description = Utils.createElement('p', 'text-gray-600', category.description);
                
                titleGroup.appendChild(title);
                titleGroup.appendChild(description);
                
                const progressGroup = Utils.createElement('div', 'flex flex-col items-end');
                const progressText = Utils.createElement('span', 'font-bold', `${category.progress}% Complet`);
                const progressBar = Utils.createElement('div', 'progress-bar w-40');
                const progressFill = Utils.createElement('div', 'progress-fill');
                progressFill.style.width = `${category.progress}%`;
                
                progressBar.appendChild(progressFill);
                progressGroup.appendChild(progressText);
                progressGroup.appendChild(progressBar);
                
                header.appendChild(titleGroup);
                header.appendChild(progressGroup);
                
                container.appendChild(header);
                
                // Topics list
                const topicsTitle = Utils.createElement('h2', 'text-xl font-bold mb-4', 'Subiecte');
                container.appendChild(topicsTitle);
                
                const topicsGrid = Utils.createElement('div', 'grid grid-cols-1 md:grid-cols-2 gap-4');
                
                category.topics.forEach(topic => {
                    const topicCard = Utils.createElement('div', 'topic-card card');
                    topicCard.addEventListener('click', () => {
                        AppState.setState({ 
                            currentPage: 'topic',
                            currentTopic: topic.id
                        });
                    });
                    
                    const header = Utils.createElement('div', 'topic-header');
                    const title = Utils.createElement('h3', 'topic-title', topic.name);
                    const status = Utils.createElement('span', `topic-status ${topic.completed ? 'completed' : topic.completed === false ? 'in-progress' : 'not-started'}`);
                    status.textContent = topic.completed ? 'Finalizat' : topic.completed === false ? 'În Progres' : 'Neînceput';
                    
                    header.appendChild(title);
                    header.appendChild(status);
                    
                    const description = Utils.createElement('p', 'topic-description', topic.description);
                    
                    const footer = Utils.createElement('div', 'topic-footer');
                    const exercisesCount = Utils.createElement('span', 'text-sm text-gray-600', `${topic.exercises.length} exerciții`);
                    const startButton = Utils.createElement('button', 'btn btn-primary btn-sm', topic.completed ? 'Revizuiește' : 'Începe');
                    
                    footer.appendChild(exercisesCount);
                    footer.appendChild(startButton);
                    
                    topicCard.appendChild(header);
                    topicCard.appendChild(description);
                    topicCard.appendChild(footer);
                    
                    topicsGrid.appendChild(topicCard);
                });
                
                container.appendChild(topicsGrid);
                
                return container;
            };
            
            return { render };
        })();

        const TopicPage = (() => {
            const render = () => {
                const state = AppState.getState();
                const category = categories.find(c => c.id === state.currentCategory);
                const topic = category?.topics.find(t => t.id === state.currentTopic);
                
                if (!topic) {
                    AppState.setState({ currentPage: 'dashboard' });
                    return Utils.createElement('div');
                }
                
                const container = Utils.createElement('div', 'main-content');
                
                // Back button
                const backButton = Utils.createElement('button', 'btn btn-ghost mb-4 flex items-center gap-2');
                const backIcon = Utils.createElement('i', 'fas fa-arrow-left');
                const backText = Utils.createElement('span', null, `Înapoi la ${category.name}`);
                
                backButton.appendChild(backIcon);
                backButton.appendChild(backText);
                backButton.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'category' });
                });
                
                container.appendChild(backButton);
                
                // Topic header
                const header = Utils.createElement('div', 'mb-6');
                const title = Utils.createElement('h1', 'text-2xl font-bold mb-2', topic.name);
                const description = Utils.createElement('p', 'text-gray-600 mb-4', topic.description);
                
                header.appendChild(title);
                header.appendChild(description);
                
                // Progress bar
                const progressBar = Utils.createElement('div', 'progress-bar mb-4');
                const progressFill = Utils.createElement('div', 'progress-fill');
                progressFill.style.width = `${topic.completed ? 100 : topic.completed === false ? 50 : 0}%`;
                
                progressBar.appendChild(progressFill);
                header.appendChild(progressBar);
                
                container.appendChild(header);
                
                // Video lesson
                const videoTitle = Utils.createElement('h2', 'text-xl font-bold mb-4', 'Lecție Video');
                container.appendChild(videoTitle);
                
                const videoPlayer = Utils.createElement('div', 'video-player');
                const videoPlaceholder = Utils.createElement('div', 'video-placeholder');
                const videoIcon = Utils.createElement('i', 'fas fa-play');
                videoPlaceholder.appendChild(videoIcon);
                videoPlayer.appendChild(videoPlaceholder);
                
                container.appendChild(videoPlayer);
                
                // Exercises
                const exercisesTitle = Utils.createElement('h2', 'text-xl font-bold mb-4 mt-8', 'Exerciții Practice');
                container.appendChild(exercisesTitle);
                
                if (topic.exercises.length === 0) {
                    const emptyState = Utils.createElement('div', 'card p-8 text-center');
                    const emptyIcon = Utils.createElement('i', 'fas fa-book-open text-3xl text-gray-400 mb-4');
                    const emptyText = Utils.createElement('p', 'text-gray-600', 'Niciun exercițiu disponibil pentru acest subiect încă. Revino în curând!');
                    
                    emptyState.appendChild(emptyIcon);
                    emptyState.appendChild(emptyText);
                    container.appendChild(emptyState);
                } else {
                    const startButton = Utils.createElement('button', 'btn btn-primary', 'Începe Exercițiile');
                    startButton.addEventListener('click', () => {
                        AppState.setState({ 
                            currentPage: 'exercise',
                            currentExercise: 0
                        });
                    });
                    
                    container.appendChild(startButton);
                }
                
                return container;
            };
            
            return { render };
        })();

        const ExercisePage = (() => {
            let selectedOption = null;
            let showFeedback = false;
            let isCorrect = false;
            
            const render = () => {
                const state = AppState.getState();
                const category = categories.find(c => c.id === state.currentCategory);
                const topic = category?.topics.find(t => t.id === state.currentTopic);
                const exercise = topic?.exercises[state.currentExercise];
                
                if (!exercise) {
                    AppState.setState({ currentPage: 'dashboard' });
                    return Utils.createElement('div');
                }
                
                const container = Utils.createElement('div', 'exercise-container main-content');
                
                // Back button
                const backButton = Utils.createElement('button', 'btn btn-ghost mb-4 flex items-center gap-2');
                const backIcon = Utils.createElement('i', 'fas fa-arrow-left');
                const backText = Utils.createElement('span', null, `Înapoi la ${topic.name}`);
                
                backButton.appendChild(backIcon);
                backButton.appendChild(backText);
                backButton.addEventListener('click', () => {
                    AppState.setState({ currentPage: 'topic' });
                });
                
                container.appendChild(backButton);
                
                // Progress indicator
                const progressText = Utils.createElement('p', 'text-center mb-4', `Exercițiul ${state.currentExercise + 1} din ${topic.exercises.length}`);
                container.appendChild(progressText);
                
                // Question
                const question = Utils.createElement('div', 'exercise-question', exercise.question);
                container.appendChild(question);
                
                // Options
                const optionsContainer = Utils.createElement('div', 'exercise-options');
                
                exercise.options.forEach((option, index) => {
                    const optionElement = Utils.createElement('div', 'exercise-option');
                    optionElement.textContent = option;
                    optionElement.dataset.index = index;
                    
                    if (showFeedback) {
                        if (index === exercise.answer) {
                            Utils.addClass(optionElement, 'correct');
                        } else if (index === selectedOption && !isCorrect) {
                            Utils.addClass(optionElement, 'incorrect');
                        }
                    } else if (selectedOption === index) {
                        Utils.addClass(optionElement, 'selected');
                    }
                    
                    if (!showFeedback) {
                        optionElement.addEventListener('click', () => selectOption(optionElement, index));
                    }
                    
                    optionsContainer.appendChild(optionElement);
                });
                
                container.appendChild(optionsContainer);
                
                // Feedback
                if (showFeedback) {
                    const feedback = Utils.createElement('div', `exercise-feedback ${isCorrect ? 'correct' : 'incorrect'}`);
                    const feedbackTitle = Utils.createElement('h3', 'font-bold mb-2', isCorrect ? 'Corect! 🎉' : 'Incorect 😕');
                    const feedbackText = Utils.createElement('p', null, exercise.explanation);
                    
                    feedback.appendChild(feedbackTitle);
                    feedback.appendChild(feedbackText);
                    container.appendChild(feedback);
                    
                    if (isCorrect && state.animationsEnabled) {
                        Utils.createConfetti();
                    }
                }
                
                // Navigation
                const navigation = Utils.createElement('div', 'exercise-navigation');
                
                if (state.currentExercise > 0) {
                    const prevButton = Utils.createElement('button', 'btn btn-outline', 'Anterior');
                    prevButton.addEventListener('click', () => {
                        AppState.setState({ 
                            currentExercise: state.currentExercise - 1,
                            currentPage: 'exercise'
                        });
                        resetExerciseState();
                    });
                    navigation.appendChild(prevButton);
                } else {
                    navigation.appendChild(Utils.createElement('div')); // Empty div for spacing
                }
                
                if (!showFeedback) {
                    const checkButton = Utils.createElement('button', 'btn btn-primary', 'Verifică Răspunsul');
                    checkButton.disabled = selectedOption === null;
                    checkButton.addEventListener('click', checkAnswer);
                    navigation.appendChild(checkButton);
                } else {
                    const nextButtonText = state.currentExercise < topic.exercises.length - 1 ? 'Următorul Exercițiu' : 'Finalizează Subiectul';
                    const nextButton = Utils.createElement('button', 'btn btn-primary', nextButtonText);
                    nextButton.addEventListener('click', () => {
                        if (state.currentExercise < topic.exercises.length - 1) {
                            AppState.setState({ 
                                currentExercise: state.currentExercise + 1,
                                currentPage: 'exercise'
                            });
                        } else {
                            // Mark topic as completed
                            const updatedCategories = categories.map(c => {
                                if (c.id === state.currentCategory) {
                                    const updatedTopics = c.topics.map(t => {
                                        if (t.id === state.currentTopic) {
                                            return { ...t, completed: true };
                                        }
                                        return t;
                                    });
                                    return { ...c, topics: updatedTopics };
                                }
                                return c;
                            });
                            
                            // Update XP and level
                            const newXp = state.xp + 100;
                            const newLevel = Math.floor(newXp / 250) + 1;
                            
                            AppState.setState({ 
                                currentPage: 'topic',
                                xp: newXp,
                                level: newLevel
                            });
                        }
                        resetExerciseState();
                    });
                    navigation.appendChild(nextButton);
                }
                
                container.appendChild(navigation);
                
                return container;
            };
            
            const selectOption = (element, index) => {
                const options = document.querySelectorAll('.exercise-option');
                options.forEach(opt => Utils.removeClass(opt, 'selected'));
                Utils.addClass(element, 'selected');
                selectedOption = index;
                
                const checkButton = document.querySelector('.exercise-navigation .btn-primary');
                if (checkButton) {
                    checkButton.disabled = false;
                }
            };
            
            const checkAnswer = () => {
                const state = AppState.getState();
                const topic = categories.find(c => c.id === state.currentCategory)?.topics.find(t => t.id === state.currentTopic);
                const exercise = topic?.exercises[state.currentExercise];
                
                isCorrect = selectedOption === exercise.answer;
                showFeedback = true;
                
                // Update state to trigger re-render
                AppState.setState({ currentPage: 'exercise' });
            };
            
            const resetExerciseState = () => {
                selectedOption = null;
                showFeedback = false;
                isCorrect = false;
            };
            
            return { render };
        })();

        const AIAssistant = (() => {
            const render = () => {
                const state = AppState.getState();
                const container = Utils.createElement('div', 'assistant-container');
                
                const button = Utils.createElement('button', 'assistant-button animate-pulse');
                const icon = Utils.createElement('i', 'fas fa-robot');
                button.appendChild(icon);
                button.addEventListener('click', () => {
                    AppState.setState({ assistantOpen: !state.assistantOpen });
                });
                
                if (state.assistantOpen) {
                    const chat = Utils.createElement('div', 'assistant-chat shadow-lg');
                    
                    const header = Utils.createElement('div', 'assistant-header');
                    const title = Utils.createElement('div', 'assistant-title', 'Asistent LearnZy AI');
                    const closeButton = Utils.createElement('button', 'assistant-close');
                    const closeIcon = Utils.createElement('i', 'fas fa-times');
                    closeButton.appendChild(closeIcon);
                    closeButton.addEventListener('click', () => {
                        AppState.setState({ assistantOpen: false });
                    });
                    
                    header.appendChild(title);
                    header.appendChild(closeButton);
                    
                    const messages = Utils.createElement('div', 'assistant-messages');
                    state.messages.forEach(msg => {
                        const message = Utils.createElement('div', `assistant-message ${msg.sender}`);
                        message.textContent = msg.text;
                        messages.appendChild(message);
                    });
                    
                    const inputContainer = Utils.createElement('div', 'assistant-input');
                    const input = Utils.createElement('input', 'assistant-input-field');
                    input.placeholder = 'Pune o întrebare de matematică...';
                    const sendButton = Utils.createElement('button', 'assistant-send');
                    const sendIcon = Utils.createElement('i', 'fas fa-paper-plane');
                    sendButton.appendChild(sendIcon);
                    
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            sendMessage(input);
                        }
                    });
                    
                    sendButton.addEventListener('click', () => {
                        sendMessage(input);
                    });
                    
                    inputContainer.appendChild(input);
                    inputContainer.appendChild(sendButton);
                    
                    chat.appendChild(header);
                    chat.appendChild(messages);
                    chat.appendChild(inputContainer);
                    
                    container.appendChild(chat);
                }
                
                container.appendChild(button);
                
                return container;
            };
            
            const sendMessage = async (input) => {
                const message = input.value.trim();
                if (!message) return;
                
                // Add user message to state
                const newMessages = [...AppState.getState().messages, { sender: 'user', text: message }];
                AppState.setState({ messages: newMessages });
                
                // Clear input
                input.value = '';
                
                // Get AI response
                try {
                    const response = await mockAPI.aiAssistant(message);
                    if (response.success) {
                        const updatedMessages = [...newMessages, { sender: 'bot', text: response.response }];
                        AppState.setState({ messages: updatedMessages });
                    }
                } catch (error) {
                    console.error('Eroare la obținerea răspunsului AI:', error);
                }
            };
            
            return { render };
        })();

        // App Router
        const App = (() => {
            const init = () => {
                const appContainer = document.getElementById('app');
                const state = AppState.getState();
                
                // Set initial theme
                document.body.setAttribute('data-theme', state.darkMode ? 'dark' : 'light');
                
                // Render function
                const render = (state) => {
                    appContainer.innerHTML = '';
                    
                    // Render navbar if not on auth pages
                    if (!['signin', 'signup', 'learning-style', 'learning-style-result'].includes(state.currentPage)) {
                        appContainer.appendChild(Navbar.render());
                        appContainer.appendChild(Sidebar.render());
                    }
                    
                    // Render current page
                    let page;
                    switch (state.currentPage) {
                        case 'signin':
                            page = SignInPage.render();
                            break;
                        case 'signup':
                            page = SignUpPage.render();
                            break;
                        case 'learning-style':
                            page = LearningStylePage.render();
                            break;
                        case 'learning-style-result':
                            page = LearningStyleResultPage.render();
                            break;
                        case 'dashboard':
                            page = DashboardPage.render();
                            break;
                        case 'category':
                            page = CategoryPage.render();
                            break;
                        case 'topic':
                            page = TopicPage.render();
                            break;
                        case 'exercise':
                            page = ExercisePage.render();
                            break;
                        default:
                            page = DashboardPage.render();
                    }
                    
                    appContainer.appendChild(page);
                    
                    // Render AI assistant if not on auth pages
                    if (!['signin', 'signup', 'learning-style', 'learning-style-result'].includes(state.currentPage)) {
                        appContainer.appendChild(AIAssistant.render());
                    }
                };
                
                // Initial render
                render(state);
                
                // Subscribe to state changes
                AppState.subscribe(render);
            };
            
            return { init };
        })();

        // Initialize the app
        document.addEventListener('DOMContentLoaded', App.init);
    </script>
</body>
</html>
