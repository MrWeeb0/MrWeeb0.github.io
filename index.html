<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LearnZy - AI Math Tutoring</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://unpkg.com/react-router-dom@6/dist/react-router-dom.development.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      plugins: [require('@tailwindcss/forms')]
    }
  </script>
  <style>
    [data-darkmode] body { background: #1a202c; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, createContext, useContext } = React;
    const { BrowserRouter, Routes, Route, Link, useNavigate, useParams } = ReactRouterDOM;

    // App Context
    const AppContext = createContext();
    
    function AppProvider({ children }) {
      const [user, setUser] = useState(null);
      const [darkMode, setDarkMode] = useState(false);
      const [language, setLanguage] = useState('en');
      const [learningStyle, setLearningStyle] = useState(null);
      const [progress, setProgress] = useState({ xp: 0, level: 1 });
      
      const login = (email) => {
        setUser({ email });
        localStorage.setItem('user', JSON.stringify({ email }));
      };
      
      const logout = () => {
        setUser(null);
        localStorage.removeItem('user');
      };
      
      const addXP = (amount) => {
        setProgress(p => {
          const newXP = p.xp + amount;
          const newLevel = Math.floor(newXP / 100) + 1;
          return { xp: newXP, level: newLevel };
        });
      };
      
      useEffect(() => {
        const savedUser = localStorage.getItem('user');
        if (savedUser) setUser(JSON.parse(savedUser));
      }, []);

      return (
        <AppContext.Provider value={{
          user, login, logout,
          darkMode, setDarkMode,
          language, setLanguage,
          learningStyle, setLearningStyle,
          progress, addXP
        }}>
          {children}
        </AppContext.Provider>
      );
    }

    const useApp = () => useContext(AppContext);

    // Components
    function Header() {
      const { user, logout, darkMode, setDarkMode } = useApp();
      return (
        <header className="bg-indigo-600 text-white p-4">
          <div className="container mx-auto flex justify-between items-center">
            <Link to="/" className="text-2xl font-bold">LearnZy</Link>
            <div className="flex items-center space-x-4">
              <button 
                onClick={() => setDarkMode(!darkMode)}
                className="p-2 rounded-full hover:bg-indigo-500"
              >
                {darkMode ? '‚òÄÔ∏è' : 'üåô'}
              </button>
              {user ? (
                <>
                  <span>{user.email}</span>
                  <button onClick={logout} className="bg-white text-indigo-600 px-4 py-1 rounded">
                    Logout
                  </button>
                </>
              ) : (
                <Link to="/auth/login" className="bg-white text-indigo-600 px-4 py-1 rounded">
                  Login
                </Link>
              )}
            </div>
          </div>
        </header>
      );
    }

    function Home() {
      return (
        <div className="text-center p-8">
          <h1 className="text-4xl font-bold mb-4">LearnZy</h1>
          <p className="mb-8">AI-powered math tutoring for Moldova</p>
          <div className="space-x-4">
            <Link to="/auth/login" className="bg-blue-500 text-white px-4 py-2 rounded">
              Log In
            </Link>
            <a href="mailto:goutcontact851@gmail.com" className="border px-4 py-2 rounded">
              Contact Us
            </a>
          </div>
        </div>
      );
    }

    function Auth({ mode }) {
      const { login } = useApp();
      const navigate = useNavigate();
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');

      const handleSubmit = (e) => {
        e.preventDefault();
        login(email);
        navigate('/dashboard');
      };

      return (
        <div className="max-w-md mx-auto p-8">
          <h2 className="text-2xl font-bold mb-6">{mode === 'login' ? 'Login' : 'Sign Up'}</h2>
          <form onSubmit={handleSubmit} className="space-y-4">
            <input
              type="email"
              value={email}
              onChange={(e) => setEmail(e.target.value)}
              className="w-full p-2 border rounded"
              placeholder="Email"
              required
            />
            <input
              type="password"
              value={password}
              onChange={(e) => setPassword(e.target.value)}
              className="w-full p-2 border rounded"
              placeholder="Password"
              required
            />
            <button type="submit" className="w-full bg-blue-500 text-white p-2 rounded">
              {mode === 'login' ? 'Log In' : 'Sign Up'}
            </button>
          </form>
        </div>
      );
    }

    function Dashboard() {
      const { user, progress } = useApp();
      const mathTopics = ['Algebra', 'Geometry', 'Calculus'];

      return (
        <div className="p-4">
          <h1 className="text-2xl font-bold">Welcome, {user?.email}</h1>
          <div className="my-4 p-4 bg-gray-100 dark:bg-gray-800 rounded">
            <h3 className="font-semibold">Progress: Level {progress.level}</h3>
            <div className="h-4 bg-gray-300 rounded-full mt-2">
              <div 
                className="h-full bg-green-500 rounded-full" 
                style={{ width: `${progress.xp % 100}%` }}
              />
            </div>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
            {mathTopics.map(topic => (
              <div key={topic} className="p-4 border rounded hover:shadow-md dark:border-gray-700">
                <h3 className="text-xl font-semibold">{topic}</h3>
                <Link 
                  to={`/math/${topic.toLowerCase()}`} 
                  className="text-blue-500 hover:underline mt-2 inline-block"
                >
                  Start Learning
                </Link>
              </div>
            ))}
          </div>
        </div>
      );
    }

    function MathTopic() {
      const { params } = useParams();
      const { learningStyle, addXP } = useApp();
      const [activeTab, setActiveTab] = useState('lesson');

      const renderContent = () => {
        switch(learningStyle) {
          case 'visual': return <img src={`https://via.placeholder.com/600x300?text=${params}+Visual`} className="w-full" />;
          case 'auditory': return (
            <div className="p-4 bg-gray-100 dark:bg-gray-800 rounded">
              <p>Audio lesson about {params} would play here</p>
            </div>
          );
          default: return (
            <div className="p-4 bg-gray-100 dark:bg-gray-800 rounded">
              <h3 className="font-bold mb-2">Text Lesson: {params}</h3>
              <p>This is a detailed text explanation about {params} concepts.</p>
            </div>
          );
        }
      };

      return (
        <div className="p-4">
          <h2 className="text-2xl font-bold capitalize mb-4">{params}</h2>
          <div className="flex border-b mb-4">
            <button 
              onClick={() => setActiveTab('lesson')} 
              className={`p-2 ${activeTab === 'lesson' ? 'border-b-2 border-blue-500' : ''}`}
            >
              Lesson
            </button>
            <button 
              onClick={() => setActiveTab('practice')} 
              className={`p-2 ${activeTab === 'practice' ? 'border-b-2 border-blue-500' : ''}`}
            >
              Practice
            </button>
          </div>
          {activeTab === 'lesson' ? renderContent() : (
            <div className="p-4 bg-gray-100 dark:bg-gray-800 rounded">
              <h3 className="font-bold mb-2">Practice Problems</h3>
              <button 
                onClick={() => addXP(10)}
                className="bg-blue-500 text-white px-4 py-2 rounded mt-4"
              >
                Complete Exercise (+10 XP)
              </button>
            </div>
          )}
        </div>
      );
    }

    // App Router
    function App() {
      return (
        <AppProvider>
          <BrowserRouter>
            <Header />
            <main className="container mx-auto p-4">
              <Routes>
                <Route path="/" element={<Home />} />
                <Route path="/auth/login" element={<Auth mode="login" />} />
                <Route path="/auth/signup" element={<Auth mode="signup" />} />
                <Route path="/dashboard" element={<Dashboard />} />
                <Route path="/math/:params" element={<MathTopic />} />
              </Routes>
            </main>
          </BrowserRouter>
        </AppProvider>
      );
    }

    // Render
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>